{% extends "base.html" %}
{% block title %}Home | Saytaman{% endblock %}
{% load static %}{% load i18n %}
{% block content %}

{% if user.is_authenticated %}
<div class="container d-flex justify-content-end mt-2 mb-5">
    <a href="{% url 'add_mission' %}" class="btn btn-primary btn-large">{% trans "Add Mission" %}</a>
</div>
{% endif %}

<div class="text-center py-5">
    <h1 class="display-4 mb-3">{% trans 'Saytaman Social Welfare Association' %}</h1>
    <p class="lead mb-4">
        {% trans 'Reaching People In Need. Mandalay, Myanmar' %}
        <br>
    </p>
</div>

{% load mission_records_tags %}
{% latest_missions as latest_missions %}
<div class="soft-ui-banner">

    <h5 class="mb-2">{% trans "Latest Ambulance Responses" %}</h5>
    <div class="row">
        {% for m in latest_missions %}

        <div class="col-12 col-md-3 col-lg-4 mb-3">
            <div class="soft-ui-card w-100 index-mission-card">

                <a href="{% url 'mission_details' m.pk %}" class="text-decoration-none text-reset">
                    <div class="card-body d-flex flex-column justify-content-between">
                        <h5 class="card-title"><strong>{{ m.mission_number }}</strong></h5>
                        <p class="card-text mb-1">{{ m.date }} {{ m.time }}</p>
                        <p class="card-text mb-1">
                            {% if m.patient_name %}{{ m.patient_name }}{% endif %}{% if m.patient_age %}, {{ m.patient_age }} years old {% endif %}
                        </p>
                        <p class="card-text mb-1">{{ m.departure }} &rarr; {{ m.destination }}</p>
                        <p class="card-text mb-0 mt-auto"><small>{{ m.vehicle.vehicle_id }}</small></p>
                    </div>
                </a>
                {% if user.is_authenticated and not m.back_to_hq %}
                <div class="mt-3">
                    <form method="POST" action="{% url 'set_back_to_hq' m.pk %}" class="d-flex justify-content-end">
                        {% csrf_token %}
                        <button type="submit" class="btn btn-success rounded-pill"
                                onclick="return confirm('Are you sure you want to mark the vehicle as returned to HQ and set status to STAND-BY?');">
                            <i class="bi bi-check2-circle"></i> {% trans "Report to HQ" %}
                        </button>
                    </form>
                </div>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    <div class="d-flex justify-content-end">
        <a href="{% url 'mission_list' %}" class="btn btn-lime">{% trans "View all missions" %}</a>
    </div>
</div>

<div class="card-group">
    <div class="card soft-ui-card">
        <img src="{% static 'site_media/card_img_1.jpg' %}" class="card-img-top w-auto h-100" alt="">
        <div class="card-body">
            <h5 class="card-title">{% trans "Emergency Response" %}</h5>
            <p class="card-text">{% trans "Rapid ambulance dispatch and first response services." %}</p>
        </div>
    </div>

    <div class="card soft-ui-card">
        <img src="{% static 'site_media/card_img_2.jpg' %}" class="card-img-top w-auto h-100" alt="">
        <div class="card-body">
            <h5 class="card-title">{% trans "Emergency Response" %}</h5>
            <p class="card-text">{% trans "Rapid ambulance dispatch and first response services." %}</p>
        </div>
    </div>

    <div class="card soft-ui-card">
        <img src="{% static 'site_media/card_img_3.jpg' %}" class="card-img-top w-auto h-100" alt="">
        <div class="card-body">
            <h5 class="card-title">{% trans "Emergency Response" %}</h5>
            <p class="card-text">{% trans "Rapid ambulance dispatch and first response services." %}</p>
        </div>
    </div>
</div>

<div class="row text-center mt-5">
    <div class="col-md-4">
        <h1 class="display-3 fw-bold lime-accent" id="missions_count">0</h1>
        <p class="lead">Emergency & Routine Transports</p>
    </div>

    <div class="col-md-4">
        <h1 class="display-3 fw-bold lime-accent" id="aid_delivered_count">0</h1>
        <p class="lead">Meals and Aid Items Distributed</p>
    </div>

    <div class="col-md-4">
        <h1 class="display-3 fw-bold lime-accent" id="water_projects">0</h1>
        <p class="lead">Clean Water Projects Completed</p>
    </div>
</div>

<div class="soft-ui-banner">
    <h6 class="mb-2">{% trans "Quick Links" %}</h6>
    <ul class="list-unstyled">
        <li><a href="#">{% trans "Articles" %}</a></li>
        <li><a href="#">{% trans "About Us" %}</a></li>
        <li><a href="#">{% trans "Contact" %}</a></li>
    </ul>
    <hr />
    <h6 class="mb-2">{% trans "Hotline" %}</h6>
    <p class="small">{% trans "Phone" %}: +95 9 43100 786, +95 9 4444 57 786</p>
</div>

{% endblock %}